<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iterative Knowledge Builder - Phase 1 Demo</title>
    <style>
        :root {
            --bg: #0a1628;
            --surface: #142536;
            --border: #1f2d3b;
            --text: #e6eef6;
            --muted: #8b9dc3;
            --accent: #64d2ff;
            --progress: #4ade80;
            --warning: #fbbf24;
            --error: #f87171;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: system-ui, -apple-system, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.5;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: var(--accent);
        }

        .phase-indicator {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
        }

        .phase-title {
            font-size: 1.2em;
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 8px;
        }

        .progress-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
        }

        .card-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--accent);
        }

        .progress-bar {
            background: var(--border);
            border-radius: 8px;
            height: 8px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: var(--progress);
            height: 100%;
            transition: width 0.3s ease;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            padding: 8px 0;
            border-bottom: 1px solid var(--border);
        }

        .metric:last-child {
            border-bottom: none;
        }

        .metric-value {
            font-weight: 600;
            color: var(--accent);
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .category-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            position: relative;
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .category-label {
            font-weight: 600;
            color: var(--text);
        }

        .confidence-badge {
            background: var(--progress);
            color: var(--bg);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .confidence-badge.medium {
            background: var(--warning);
        }

        .confidence-badge.low {
            background: var(--error);
        }

        .category-terms {
            margin-bottom: 15px;
        }

        .term-tag {
            display: inline-block;
            background: var(--border);
            color: var(--muted);
            padding: 2px 8px;
            border-radius: 8px;
            font-size: 0.8em;
            margin: 2px 4px 2px 0;
        }

        .document-list {
            max-height: 150px;
            overflow-y: auto;
        }

        .document-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            margin: 4px 0;
            background: var(--bg);
            border-radius: 8px;
            font-size: 0.9em;
        }

        .doc-title {
            flex: 1;
            color: var(--text);
        }

        .confidence-score {
            color: var(--muted);
            font-size: 0.8em;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--accent);
            color: var(--bg);
        }

        .btn-primary:hover {
            background: #50c7f0;
        }

        .btn-secondary {
            background: var(--surface);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .log-section {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            margin-top: 30px;
        }

        .log-entry {
            padding: 8px 0;
            border-bottom: 1px solid var(--border);
            font-family: monospace;
            font-size: 0.9em;
            color: var(--muted);
        }

        .log-entry:last-child {
            border-bottom: none;
        }

        .status-ready {
            color: var(--progress);
            font-weight: 600;
        }

        .status-pending {
            color: var(--warning);
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .progress-section {
                grid-template-columns: 1fr;
            }

            .categories-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üó∫Ô∏è Iterative Knowledge Builder - Phase 1 Demo</h1>

        <div class="phase-indicator">
            <div class="phase-title">Phase 1: Rough Landscape Mapping</div>
            <div class="phase-description">
                Surface-level analysis and initial categorization of document collection
            </div>
        </div>

        <div class="progress-section">
            <div class="card">
                <div class="card-title">Progress Overview</div>
                <div class="metric">
                    <span>Total Documents</span>
                    <span class="metric-value" id="totalDocs">0</span>
                </div>
                <div class="metric">
                    <span>Documents Categorized</span>
                    <span class="metric-value" id="categorizedDocs">0</span>
                </div>
                <div class="metric">
                    <span>User Validated</span>
                    <span class="metric-value" id="validatedDocs">0</span>
                </div>
                <div class="metric">
                    <span>Completion Rate</span>
                    <span class="metric-value" id="completionRate">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
                <div style="margin-top: 15px;">
                    <span id="phase2Status" class="status-pending">Phase 2 Status: Not Ready</span>
                </div>
            </div>

            <div class="card">
                <div class="card-title">Analysis Metrics</div>
                <div class="metric">
                    <span>Categories Discovered</span>
                    <span class="metric-value" id="categoriesCount">0</span>
                </div>
                <div class="metric">
                    <span>User Created Categories</span>
                    <span class="metric-value" id="userCategoriesCount">0</span>
                </div>
                <div class="metric">
                    <span>Feedback Interactions</span>
                    <span class="metric-value" id="feedbackCount">0</span>
                </div>
                <div class="metric">
                    <span>Avg. Confidence Score</span>
                    <span class="metric-value" id="avgConfidence">0%</span>
                </div>
            </div>
        </div>

        <div class="action-buttons">
            <button class="btn btn-primary" id="runAnalysisBtn">Run Phase 1 Analysis</button>
            <button class="btn btn-secondary" id="simulateFeedbackBtn" disabled>Simulate User Feedback</button>
            <button class="btn btn-secondary" id="exportProgressBtn" disabled>Export Progress</button>
        </div>

        <div id="categoriesSection" style="display: none;">
            <h2 style="margin: 30px 0 20px; color: var(--accent);">üìÇ Discovered Categories</h2>
            <div class="categories-grid" id="categoriesGrid"></div>
        </div>

        <div class="log-section">
            <div class="card-title">üìã Activity Log</div>
            <div id="activityLog">
                <div class="log-entry">Ready to start Phase 1 analysis...</div>
            </div>
        </div>
    </div>

    <script src="iterative-knowledge-builder.js"></script>
    <script>
        let knowledgeBuilder = null;
        let analysisComplete = false;

        // Sample documents for demonstration
        const sampleDocuments = [
            {
                path: './vault/01_person.md',
                content: `---
title: "Alex Chen - Personal Profile"
type: person
tags: [identity, personal]
---

# Alex Chen - Personal Profile

## Professional Background
Senior Software Engineer with focus on systems thinking and knowledge management.

## Interests
- Personal knowledge management
- Systems thinking
- Technology trends
- Career development`
            },
            {
                path: './vault/02_biography.md',
                content: `---
title: "Personal Biography Notes"
type: biography
---

# Personal Biography Notes

## Early Career
Started in web development, transitioned to systems architecture.

## Current Focus
Building tools for personal knowledge management and productivity.

## Future Goals
Developing AI-assisted knowledge systems.`
            },
            {
                path: './vault/03_career-research.md',
                content: `---
title: "Career Research Project"
type: project
status: active
---

# Career Research Project

## Objective
Research emerging roles in AI and knowledge management.

## Tasks
- [ ] Research AI/ML engineer positions
- [ ] Study knowledge graph technologies
- [ ] Network with industry professionals
- [ ] Update portfolio with relevant projects

## Timeline
Target completion: Q2 2024`
            },
            {
                path: './vault/04_family-tasks.md',
                content: `---
title: "Family Management Tasks"
type: tasks
---

# Family Management Tasks

## Household
- [ ] Plan summer vacation
- [ ] Organize family photos
- [ ] Schedule home maintenance

## Relationships
- [ ] Call parents weekly
- [ ] Plan date nights
- [ ] Organize family reunion`
            },
            {
                path: './vault/05_travel-log.md',
                content: `---
title: "Travel Experiences Log"
type: log
---

# Travel Experiences Log

## Recent Trips
- Tokyo, Japan - Technology conference
- San Francisco - Company retreat
- New York - Family visit

## Planning
- Europe backpacking trip
- Mountain hiking adventure
- Beach vacation with family`
            },
            {
                path: './vault/06_research-notes.md',
                content: `---
title: "Research and Learning Notes"
type: research
---

# Research and Learning Notes

## Current Topics
- Machine learning applications
- Knowledge graph technologies
- Personal productivity systems
- Cognitive science principles

## Methodologies
- Literature review process
- Note-taking strategies
- Information synthesis techniques`
            },
            {
                path: './vault/07_concept-systems-thinking.md',
                content: `---
title: "Systems Thinking Concepts"
type: concept
---

# Systems Thinking Concepts

## Core Principles
- Holistic perspective
- Interconnectedness
- Feedback loops
- Emergence

## Applications
- Organizational design
- Problem solving
- Personal development
- Technology architecture

## Related Concepts
- Complexity theory
- Network effects
- Cybernetics`
            },
            {
                path: './vault/08_meeting-notes.md',
                content: `---
title: "Professional Meeting Notes"
type: notes
---

# Professional Meeting Notes

## Weekly Team Meetings
- Project status updates
- Technical discussions
- Planning sessions

## Client Meetings
- Requirements gathering
- Progress reviews
- Feedback sessions

## Conference Notes
- Industry trends
- New technologies
- Networking contacts`
            },
            {
                path: './vault/09_health-tasks.md',
                content: `---
title: "Health and Wellness Tasks"
type: tasks
category: health
---

# Health and Wellness Tasks

## Fitness Goals
- [ ] Run 3 times per week
- [ ] Join gym membership
- [ ] Track daily steps

## Medical
- [ ] Annual checkup
- [ ] Dental cleaning
- [ ] Eye exam

## Mental Health
- [ ] Meditation practice
- [ ] Stress management techniques
- [ ] Work-life balance improvement`
            },
            {
                path: './vault/10_ideas-kanban.md',
                content: `---
title: "Ideas and Innovation Board"
type: kanban
---

# Ideas and Innovation Board

## Backlog
- AI-powered note organization
- Voice-to-text integration
- Cross-platform synchronization
- Collaborative knowledge sharing

## In Progress
- Semantic addressing system
- Graph visualization improvements

## Done
- Basic markdown support
- File system integration
- Search functionality`
            }
        ];

        // UI Management
        function updateProgress(progressData) {
            document.getElementById('totalDocs').textContent = progressData.totalDocuments;
            document.getElementById('categorizedDocs').textContent = progressData.categorized;
            document.getElementById('validatedDocs').textContent = progressData.validated;
            document.getElementById('completionRate').textContent = progressData.completionRate + '%';
            document.getElementById('progressFill').style.width = progressData.completionRate + '%';

            document.getElementById('categoriesCount').textContent = progressData.categories.length;

            const userCreated = progressData.categories.filter(c => c.userCreated).length;
            document.getElementById('userCategoriesCount').textContent = userCreated;

            const avgConfidence = progressData.categories.length > 0
                ? Math.round(progressData.categories.reduce((sum, c) => sum + (c.confidence || 0), 0) / progressData.categories.length * 100)
                : 0;
            document.getElementById('avgConfidence').textContent = avgConfidence + '%';

            const phase2Status = document.getElementById('phase2Status');
            if (progressData.readyForPhase2) {
                phase2Status.textContent = 'Phase 2 Status: Ready to Proceed!';
                phase2Status.className = 'status-ready';
            } else {
                phase2Status.textContent = 'Phase 2 Status: Not Ready (need 80%+ completion)';
                phase2Status.className = 'status-pending';
            }
        }

        function renderCategories(categories, assignments) {
            const grid = document.getElementById('categoriesGrid');
            grid.innerHTML = '';

            categories.forEach(category => {
                const categoryDocs = Array.from(assignments.entries())
                    .filter(([docId, assignment]) => assignment.categoryId === category.id);

                const confidence = Math.round((category.confidence || 0) * 100);
                let confidenceClass = 'high';
                if (confidence < 70) confidenceClass = 'medium';
                if (confidence < 50) confidenceClass = 'low';

                const card = document.createElement('div');
                card.className = 'category-card';
                card.innerHTML = `
                    <div class="category-header">
                        <div class="category-label">${category.label}</div>
                        <div class="confidence-badge ${confidenceClass}">${confidence}%</div>
                    </div>
                    <div class="category-terms">
                        ${(category.topTerms || []).slice(0, 5).map(term =>
                            `<span class="term-tag">${term.term || term}</span>`
                        ).join('')}
                    </div>
                    <div class="document-list">
                        ${categoryDocs.map(([docId, assignment]) => {
                            const docName = docId.replace('./vault/', '').replace('.md', '');
                            const docConfidence = Math.round((assignment.confidence || 0) * 100);
                            return `
                                <div class="document-item">
                                    <div class="doc-title">${docName}</div>
                                    <div class="confidence-score">${docConfidence}%</div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
                grid.appendChild(card);
            });

            document.getElementById('categoriesSection').style.display = 'block';
        }

        function addLogEntry(message) {
            const log = document.getElementById('activityLog');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        // Event Handlers
        document.getElementById('runAnalysisBtn').addEventListener('click', async () => {
            const btn = document.getElementById('runAnalysisBtn');
            btn.disabled = true;
            btn.textContent = 'Running Analysis...';

            addLogEntry('üöÄ Starting Phase 1 analysis...');

            try {
                knowledgeBuilder = new IterativeKnowledgeBuilder();

                addLogEntry('üìä Analyzing document features...');
                await new Promise(resolve => setTimeout(resolve, 1000)); // Simulate processing time

                addLogEntry('üîó Performing clustering analysis...');
                await new Promise(resolve => setTimeout(resolve, 1500));

                addLogEntry('üè∑Ô∏è Generating category labels...');
                await new Promise(resolve => setTimeout(resolve, 1000));

                const result = await knowledgeBuilder.phase1_roughMapping(sampleDocuments);

                addLogEntry(`‚úÖ Analysis complete! Discovered ${result.categories.length} categories`);
                addLogEntry(`üìù Assigned ${result.assignments.length} documents to categories`);

                updateProgress(knowledgeBuilder.getProgressReport());
                renderCategories(result.categories, new Map(result.assignments));

                document.getElementById('simulateFeedbackBtn').disabled = false;
                document.getElementById('exportProgressBtn').disabled = false;
                analysisComplete = true;

                btn.textContent = 'Analysis Complete';

            } catch (error) {
                addLogEntry(`‚ùå Error during analysis: ${error.message}`);
                btn.disabled = false;
                btn.textContent = 'Run Phase 1 Analysis';
            }
        });

        document.getElementById('simulateFeedbackBtn').addEventListener('click', async () => {
            if (!knowledgeBuilder) return;

            const btn = document.getElementById('simulateFeedbackBtn');
            btn.disabled = true;
            btn.textContent = 'Simulating...';

            addLogEntry('ü§ù Simulating user feedback...');

            // Simulate accepting some assignments
            const assignments = Array.from(knowledgeBuilder.assignments.entries());
            const toAccept = assignments.slice(0, Math.floor(assignments.length * 0.6));

            for (const [docId, assignment] of toAccept) {
                await knowledgeBuilder.acceptCategoryAssignment(docId, assignment.categoryId);
                await new Promise(resolve => setTimeout(resolve, 200));
            }

            addLogEntry(`‚úÖ Accepted ${toAccept.length} category assignments`);

            // Create a new category
            const personalDocs = assignments
                .filter(([docId]) => docId.includes('person') || docId.includes('biography'))
                .map(([docId]) => docId);

            if (personalDocs.length > 0) {
                await knowledgeBuilder.createNewCategory(
                    'Personal Development',
                    'Documents related to personal growth and identity',
                    personalDocs
                );
                addLogEntry('üìÇ Created new category: Personal Development');
            }

            // Update feedback count
            const progressReport = knowledgeBuilder.getProgressReport();
            document.getElementById('feedbackCount').textContent = knowledgeBuilder.userFeedback.length;

            updateProgress(progressReport);
            renderCategories(progressReport.categories, new Map(progressReport.assignments));

            addLogEntry('üéâ User feedback simulation complete!');

            btn.disabled = false;
            btn.textContent = 'Simulate More Feedback';
        });

        document.getElementById('exportProgressBtn').addEventListener('click', () => {
            if (!knowledgeBuilder) return;

            const exportData = knowledgeBuilder.exportProgress();
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);

            const a = document.createElement('a');
            a.href = url;
            a.download = `knowledge-builder-phase1-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            addLogEntry('üíæ Progress exported to JSON file');
        });

        // Initialize UI
        addLogEntry('üéØ Demo ready - click "Run Phase 1 Analysis" to begin');
    </script>
</body>
</html>
